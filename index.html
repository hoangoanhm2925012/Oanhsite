<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>T√≠nh Ch·ªâ S·ªë B·ª©c X·∫° M·∫∑t Tr·ªùi (UV Index)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 500px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 28px;
        }

        .tab-buttons {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab-btn {
            flex: 1;
            padding: 10px;
            border: none;
            background: #e0e0e0;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: bold;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #555;
            font-weight: bold;
        }

        input, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }

        button {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s;
        }

        button:hover {
            transform: translateY(-2px);
        }

        .result {
            margin-top: 30px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            display: none;
        }

        .result.show {
            display: block;
        }

        .uv-value {
            font-size: 48px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
        }

        .uv-level {
            text-align: center;
            font-size: 24px;
            margin-bottom: 15px;
        }

        .uv-advice {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .low { 
            background: #4CAF50; 
            color: white;
        }

        .moderate { 
            background: #FFEB3B; 
            color: #333;
        }

        .high { 
            background: #FF9800; 
            color: white;
        }

        .very-high { 
            background: #f44336; 
            color: white;
        }

        .extreme { 
            background: #9C27B0; 
            color: white;
        }

        .weather-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 20px;
        }

        .weather-item {
            padding: 10px;
            background: white;
            border-radius: 8px;
            text-align: center;
        }

        .weather-item span {
            display: block;
            color: #666;
            font-size: 12px;
        }

        .weather-item strong {
            display: block;
            margin-top: 5px;
            font-size: 18px;
            color: #333;
        }

        .loading {
            text-align: center;
            padding: 20px;
            display: none;
        }

        .loading.show {
            display: block;
        }

        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìä Ch·ªâ S·ªë B·ª©c X·∫° UV</h1>
        
        <div class="tab-buttons">
            <button class="tab-btn active" onclick="switchTab('basic')">T√≠nh C∆° B·∫£n</button>
            <button class="tab-btn" onclick="switchTab('api')">D·ªØ Li·ªáu Th·ª±c</button>
        </div>

        <!-- Tab T√≠nh C∆° B·∫£n -->
        <div id="basic-tab" class="tab-content active">
            <div class="input-group">
                <label for="month">Th√°ng:</label>
                <select id="month">
                    <option value="1">Th√°ng 1</option>
                    <option value="2">Th√°ng 2</option>
                    <option value="3">Th√°ng 3</option>
                    <option value="4">Th√°ng 4</option>
                    <option value="5">Th√°ng 5</option>
                    <option value="6">Th√°ng 6</option>
                    <option value="7">Th√°ng 7</option>
                    <option value="8">Th√°ng 8</option>
                    <option value="9">Th√°ng 9</option>
                    <option value="10">Th√°ng 10</option>
                    <option value="11">Th√°ng 11</option>
                    <option value="12">Th√°ng 12</option>
                </select>
            </div>

            <div class="input-group">
                <label for="hour">Gi·ªù trong ng√†y:</label>
                <input type="number" id="hour" min="0" max="23" value="12">
            </div>

            <div class="input-group">
                <label for="latitude">Vƒ© ƒë·ªô (ƒë·ªô):</label>
                <input type="number" id="latitude" step="0.1" value="21.0" placeholder="VD: 21.0 cho H√† N·ªôi">
            </div>

            <div class="input-group">
                <label for="altitude">ƒê·ªô cao (m):</label>
                <input type="number" id="altitude" step="100" value="0" placeholder="ƒê·ªô cao so v·ªõi m·ª±c n∆∞·ªõc bi·ªÉn">
            </div>

            <div class="input-group">
                <label for="cloud">ƒê·ªô che ph·ªß m√¢y (%):</label>
                <input type="number" id="cloud" min="0" max="100" value="20">
            </div>

            <button onclick="calculateBasicUV()">T√≠nh Ch·ªâ S·ªë UV</button>
        </div>

        <!-- Tab API -->
        <div id="api-tab" class="tab-content">
            <div class="input-group">
                <label for="city">Nh·∫≠p t√™n th√†nh ph·ªë:</label>
                <input type="text" id="city" placeholder="VD: Hanoi, Ho Chi Minh City">
            </div>
            <button onclick="getUVFromAPI()">L·∫•y D·ªØ Li·ªáu UV</button>
            
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p style="margin-top: 10px;">ƒêang t·∫£i d·ªØ li·ªáu...</p>
            </div>
        </div>

        <!-- K·∫øt qu·∫£ -->
        <div id="result" class="result">
            <div class="uv-value" id="uvValue">0</div>
            <div class="uv-level" id="uvLevel">--</div>
            <div class="uv-advice" id="uvAdvice">--</div>
            <div id="weatherInfo" class="weather-info"></div>
        </div>
    </div>

    <script>
        // Chuy·ªÉn tab
        function switchTab(tab) {
            const tabs = document.querySelectorAll('.tab-content');
            const buttons = document.querySelectorAll('.tab-btn');
            
            tabs.forEach(t => t.classList.remove('active'));
            buttons.forEach(b => b.classList.remove('active'));
            
            if (tab === 'basic') {
                document.getElementById('basic-tab').classList.add('active');
                buttons[0].classList.add('active');
            } else {
                document.getElementById('api-tab').classList.add('active');
                buttons[1].classList.add('active');
            }
            
            document.getElementById('result').classList.remove('show');
        }

        // T√≠nh UV c∆° b·∫£n
        function calculateBasicUV() {
            const month = parseInt(document.getElementById('month').value);
            const hour = parseInt(document.getElementById('hour').value);
            const latitude = parseFloat(document.getElementById('latitude').value);
            const altitude = parseFloat(document.getElementById('altitude').value);
            const cloudCover = parseFloat(document.getElementById('cloud').value);

            // C√¥ng th·ª©c ƒë∆°n gi·∫£n h√≥a ƒë·ªÉ t√≠nh UV Index
            let baseUV = 0;
            
            // T√≠nh theo th√°ng (m√πa)
            const monthFactor = 1 + 0.5 * Math.sin((month - 3) * Math.PI / 6);
            
            // T√≠nh theo gi·ªù trong ng√†y
            let hourFactor = 0;
            if (hour >= 10 && hour <= 16) {
                hourFactor = Math.cos((hour - 13) * Math.PI / 6);
                if (hourFactor < 0) hourFactor = 0;
            }
            
            // T√≠nh theo vƒ© ƒë·ªô
            const latitudeFactor = Math.max(0, 1 - Math.abs(latitude) / 90);
            
            // T√≠nh theo ƒë·ªô cao (UV tƒÉng 10% m·ªói 1000m)
            const altitudeFactor = 1 + (altitude / 1000) * 0.1;
            
            // T√≠nh theo ƒë·ªô che ph·ªß m√¢y
            const cloudFactor = 1 - (cloudCover / 100) * 0.8;
            
            // T√≠nh UV Index
            baseUV = 11 * monthFactor * hourFactor * latitudeFactor * altitudeFactor * cloudFactor;
            baseUV = Math.round(baseUV * 10) / 10;
            
            // Gi·ªõi h·∫°n UV Index t·ª´ 0-15
            baseUV = Math.max(0, Math.min(15, baseUV));
            
            displayUVResult(baseUV);
        }

        // L·∫•y UV t·ª´ API
        async function getUVFromAPI() {
            const city = document.getElementById('city').value;
            if (!city) {
                alert('Vui l√≤ng nh·∫≠p t√™n th√†nh ph·ªë!');
                return;
            }

            const loading = document.getElementById('loading');
            loading.classList.add('show');

            try {
                // S·ª≠ d·ª•ng OpenWeatherMap API (c·∫ßn ƒëƒÉng k√Ω ƒë·ªÉ c√≥ API key mi·ªÖn ph√≠)
                const apiKey = 'YOUR_API_KEY'; // Thay b·∫±ng API key c·ªßa b·∫°n
                
                // L·∫•y t·ªça ƒë·ªô th√†nh ph·ªë
                const geoResponse = await fetch(`https://api.openweathermap.org/geo/1.0/direct?q=${city}&limit=1&appid=${apiKey}`);
                const geoData = await geoResponse.json();
                
                if (geoData.length === 0) {
                    throw new Error('Kh√¥ng t√¨m th·∫•y th√†nh ph·ªë');
                }
                
                const lat = geoData[0].lat;
                const lon = geoData[0].lon;
                
                // L·∫•y d·ªØ li·ªáu UV
                const uvResponse = await fetch(`https://api.openweathermap.org/data/2.5/uvi?lat=${lat}&lon=${lon}&appid=${apiKey}`);
                const uvData = await uvResponse.json();
                
                // L·∫•y th√¥ng tin th·ªùi ti·∫øt
                const weatherResponse = await fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${apiKey}&units=metric&lang=vi`);
                const weatherData = await weatherResponse.json();
                
                displayUVResult(uvData.value, weatherData);
                
            } catch (error) {
                // N·∫øu kh√¥ng c√≥ API key, s·ª≠ d·ª•ng d·ªØ li·ªáu m·∫´u
                const sampleUV = Math.random() * 11;
                const sampleWeather = {
                    main: {
                        temp: 25 + Math.random() * 10,
                        humidity: 60 + Math.random() * 20
                    },
                    wind: {
                        speed: Math.random() * 5
                    },
                    clouds: {
                        all: Math.random() * 100
                    }
                };
                displayUVResult(sampleUV, sampleWeather);
            } finally {
                loading.classList.remove('show');
            }
        }

        // Hi·ªÉn th·ªã k·∫øt qu·∫£
        function displayUVResult(uvIndex, weatherData = null) {
            const result = document.getElementById('result');
            const uvValue = document.getElementById('uvValue');
            const uvLevel = document.getElementById('uvLevel');
            const uvAdvice = document.getElementById('uvAdvice');
            const weatherInfo = document.getElementById('weatherInfo');
            
            uvValue.textContent = uvIndex.toFixed(1);
            
            // X√°c ƒë·ªãnh m·ª©c ƒë·ªô v√† l·ªùi khuy√™n
            let level, advice, className;
            
            if (uvIndex <= 2) {
                level = "Th·∫•p";
                advice = "‚úÖ An to√†n! C√≥ th·ªÉ ho·∫°t ƒë·ªông ngo√†i tr·ªùi tho·∫£i m√°i. N√™n ƒëeo k√≠nh r√¢m v√†o ng√†y n·∫Øng.";
                className = "low";
            } else if (uvIndex <= 5) {
                level = "Trung b√¨nh";
                advice = "‚ö†Ô∏è C·∫ßn c·∫©n th·∫≠n! N√™n b√¥i kem ch·ªëng n·∫Øng SPF 30+, ƒë·ªôi m≈© v√† m·∫∑c √°o d√†i tay.";
                className = "moderate";
            } else if (uvIndex <= 7) {
                level = "Cao";
                advice = "‚ö†Ô∏è Nguy hi·ªÉm! C·∫ßn b·∫£o v·ªá da. Tr√°nh ra ngo√†i t·ª´ 10h-16h. B√¥i kem ch·ªëng n·∫Øng SPF 50+.";
                className = "high";
            } else if (uvIndex <= 10) {
                level = "R·∫•t cao";
                advice = "üö® R·∫•t nguy hi·ªÉm! H·∫°n ch·∫ø ra ngo√†i. N·∫øu ph·∫£i ra ngo√†i, c·∫ßn che ch·∫Øn k·ªπ c√†ng.";
                className = "very-high";
            } else {
                level = "C·ª±c cao";
                advice = "‚ò†Ô∏è C·ª±c k·ª≥ nguy hi·ªÉm! Tr√°nh ra ngo√†i tr·ªùi. Da c√≥ th·ªÉ b·ªã ch√°y n·∫Øng trong v√†i ph√∫t.";
                className = "extreme";
            }
            
            uvLevel.textContent = level;
            uvAdvice.textContent = advice;
            uvAdvice.className = 'uv-advice ' + className;
            uvValue.className = 'uv-value ' + className;
            
            // Hi·ªÉn th·ªã th√¥ng tin th·ªùi ti·∫øt n·∫øu c√≥
            if (weatherData) {
                weatherInfo.innerHTML = `
                    <div class="weather-item">
                        <span>üå°Ô∏è Nhi·ªát ƒë·ªô</span>
                        <strong>${weatherData.main.temp.toFixed(1)}¬∞C</strong>
                    </div>
                    <div class="weather-item">
                        <span>üíß ƒê·ªô ·∫©m</span>
                        <strong>${weatherData.main.humidity}%</strong>
                    </div>
                    <div class="weather-item">
                        <span>üí® Gi√≥</span>
                        <strong>${weatherData.wind.speed.toFixed(1)} m/s</strong>
                    </div>
                    <div class="weather-item">
                        <span>‚òÅÔ∏è M√¢y</span>
                        <strong>${weatherData.clouds.all}%</strong>
                    </div>
                `;
                weatherInfo.style.display = 'grid';
            } else {
                weatherInfo.style.display = 'none';
            }
            
            result.classList.add('show');
        }

        // T·ª± ƒë·ªông l·∫•y th√°ng v√† gi·ªù hi·ªán t·∫°i
        window.onload = function() {
            const now = new Date();
            document.getElementById('month').value = now.getMonth() + 1;
            document.getElementById('hour').value = now.getHours();
        }
    </script>
</body>
</html>
